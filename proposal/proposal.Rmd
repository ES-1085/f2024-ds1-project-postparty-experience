---
title: "Project proposal"
author: "Postparty Experience"
output: html_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readxl)
Postpartum_Experience_Survey_Responses_raw_data <- read_excel("../data/Postpartum Experience Survey (Responses) - raw data.xlsx")
#View(Postpartum_Experience_Survey_Responses_raw_data)
```


### 1. Introduction

The postpartum experience survey was created by Willow Gibson for a research project assigned in an undergraduate course titled "History of Midwifery and Women's Healthcare in the US" at College of the Atlantic in 2022. The survey was used to collect data about the postpartum experiences of anyone who gave birth between 2013 and 2023. The purpose of collecting this information was to observe the state of postpartum care in the US with aim of learning what gaps in care exist. 

Data was collected to through a Google form survey that was circulated via email and briefly on social media. This dataset contains 788 cases and 15 variables. One variable (`emails`) is not being included in our analysis as it refers only to the email addresses of survey takers that wished to learn more following analysis of the data.

We expect to add one or two additional variables to our dataset through the process of mutating the types of postpartum care care into quality categories: good, better, and best. Definitions for these categories will be determined as we work to analyze our data. While we recognize that these definitions may be subjective in nature, we will be using published references to help us quantify what types of support are most fundamental to long term health vs what types of care are more optional.

For this project, we want to look more deeply at several of the relationships between variables in this dataset. Some of the questions we hope to explore are:

1. Does quality of postpartum care vary from state to state?

2. Is there a correlation between age and quality of postpartum care received/offered?

3. If we categorize postpartum care into "good", "better", and "best" categories, what quality of postpartum care is the average birther receiving?

4. What states require postpartum care to be covered by insurance? Does that requirement for coverage extend to Medicare recipients only, or does it extend to private insurance companies?

5. What types of postpartum support did respondents say were most critical to their household within the first year following birth? Are these types of care typically covered by insurance or are families paying for these services out of pocket?

6. Critical care vs ideal care - what are the differences?

Refer to the Markdown Quick Reference: Help -> Markdown Quick Reference. 

## 2. Data

```{r dimensions}
dim(Postpartum_Experience_Survey_Responses_raw_data)
```
Variables: 15


```{r rename-variables}
Postpartum_Experience_renamed_variables <- as_tibble(Postpartum_Experience_Survey_Responses_raw_data) %>% 
  rename( 
         `respondent` = `Timestamp`,
         `state` = `Which US state or country did you give birth in?`,
          `age` = `What was your age when you gave birth?`, 
      `birth_location` = `Where did you give birth?`,
        `informed_by` = `When you were pregnant, did your care provider give you information about postpartum care services?`,
    `other_info_sources` = `Did you learn about postpartum care services from any other sources?`, 
      `support_type`= `What types of support did you have access to postpartum?`,
         `provider` = `Who provided this support for you?`,
    `ins_covered_services` = `What postpartum care services did your insurance cover?`,
    `cost_factor` = `Was cost a factor in how much support you received?`,
        `if_insurance` = `If insurance covered postpartum care services, would you take advantage of it?`,
    `critical_support` = `What support was most critical to you/your household in first year following birth?`,
    `ideal_support` = `In a best case scenario, list all types of care and support you would need or want in the first year postpartum.`,
    `comments` = `Is there anything else you want to share about your postpartum experience?`,
    `emails` = `If you are open to follow up questions or want the results from this research project, please enter your email below.`)
```

```{r excluding-international-entries}
Postpartum_renamed_variables_US <- Postpartum_Experience_renamed_variables %>%
  filter(state != "Uk") %>%
  filter(state != "Norway") %>%
  filter(state != "Puerto Rico")
```

## 3. Data analysis plan

The variables we will be visualizing to explore the research questions include (the numbers reference the questions listed in the introduction):

1. `state` and `quality` The `quality` variable will be created through defining the good, better, and best categories of care.
2. `age` and `quality` 
3. `respondent` and `quality`
4. `ins_covered_services` plus data from additional source(s)
5. `critical_support` , `timestamp` , `ins_covered_services` , and `cost_factor` We may also want to create a new variable called `out_of_pocket` to quantify what services were being paid for outside of insurance coverage.
6. `critical_care` and `ideal_care`

Other data needed:

- State by state postpartum insurance coverage requirements

- What factors are most important in postpartum care according to other sources (i.e. what services are equated with the best long term health outcomes)

- Distribution of quality of postpartum care across states

- Possible data source: Guarnizo, Tomás. “Doula Services in Medicaid: State Progress in 2022.” Center For Children and Families, Georgetown University Health Policy Institute, 2 June 2022, https://ccf.georgetown.edu/2022/06/02/doula-services-in-medicaid-state-progress-in-2022.

Types of graphs we may want to use:

 - Histograms - to compare experiences depending on `birth_location` 

 - Bubble plot - to juxtapose `critical_support` and `ins_covered_services`

 - Density plots - to compare how experiences vary with age

 - Wordclouds - to visualize the repetitions within our qualitative data

 - Maps - to compare results between US states

 - Waffle plot - comparing `ideal_support` with `critical_support`


Preliminary exploratory data analysis:

```{r informed-by-count}
Postpartum_renamed_variables_US |>
  count(informed_by) |>
  arrange(desc(n))
```


```{r histogram}
# Example data: Replace this with your actual data
tikyrabargraph <- Postpartum_renamed_variables_US

# Create the histogram
histogram <- ggplot(data = data.frame(value = tikyrabargraph), aes(x = value)) +
  geom_histogram(binwidth = 0.5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of Your Data",
       x = "Value",
       y = "Frequency") +
  theme_minimal()

#realized we probably need to figure out the good/better/best portions for the real one, id want x to be state and y to be the variable we make for the quality of care ranking

```

```{r map attempt}
#library(maps)
#library(mapproj)
#library(tidyverse)

#states <- map_data("state")
#states <- rename(states, state = region)
#statessurveyed <- `states`

#Postpartum_renamed_variables_US <- #Postpartum_renamed_variables_US %>% 
#  mutate(state = tolower(Postpartum_renamed_variables_US$state))

```


```{r distribution-of-ages}
#emmy_ages <- Postpartum_renamed_variables_US %>%
#filter(state == "California") %>%
#ggplot(emmy_ages, aes(x = seq_along(age), y = age, na.rm = #TRUE))+
#  geom_hex()

```



## 4. Data Ethics Review

The data ethics review section will be introduced in a separate class and is not part of the original proposal deadline.

